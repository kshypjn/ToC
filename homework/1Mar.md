Q : An unrestricted grammar is a grammar in which each production rule has the form $\alpha \to \beta$, where $\alpha$ is a non-empty string of terminals and/or non-terminals, and $\beta$ is any string of terminals and/or non-terminals (possibly empty). Show that the class of languages generated by unrestricted grammars is equivalent to the class of languages accepted by a nondeterministic Turing machine.

---
Let $G = (V, \Sigma, R, S)$ be an unrestricted grammar and let $L(G)$ be the language it generates.

Need a Turing machine $M$ such that $L(M) = L(G)$, where $L(M)$ is the set of strings accepted by $M$.

We know a derivation in the grammar is just a sequence of rule applications starting from $S$. A nondeterministic machine can simply guess such a derivation.

Construction:

1. On input $w \in \Sigma^*$, $M$ first copies $w$ to a separate space
2. $M$ then starts with the string $S$ on another part of the tape.
3. Nondeterministically $M$ chooses a production rule $\alpha \to \beta \in R$ and an occurrence of $\alpha$ in the current sentential form, and replaces it by $\beta$. This simulates one grammar derivation step.
4. At any time, $M$ may also nondeterministically choose to stop applying rules and check whether the current sentential form consists only of terminals and is equal to the input $w$.
5. If it is equal to $w$, $M$ enters an accepting state. Otherwise that computation branch rejects.

If $w \in L(G)$, then there exists some derivation $S \Rightarrow^* w$. One of the nondeterministic branches of $M$ will exactly follow that derivation and accept $w$. So $w$ has an accepting computation.

If $w \notin L(G)$, then no derivation from $S$ leads to $w$. Therefore there is no branch of $M$ that both halts and accepts on input $w$. So $w \notin L(M)$.

Thus every language generated by an unrestricted grammar is accepted by some nondeterministic Turing machine.

---
Now let $M$ be a nondeterministic Turing machine, and let $L(M)$ be the language it accepts. We want an unrestricted grammar $G$ such that $L(G) = L(M)$.

Encoding configurations:

We can represent a configuration of $M$ as a string of the form
\[
u q a v
\]
where:

- $u, v$ are strings over the tape alphabet (cells to the left and right of the head),
- $a$ is the symbol currently under the head,
- $q$ is the current state, written next to the symbol under the head.

The start configuration on an input $w = a_1 a_2 \dots a_n$ can be encoded as
$q_0 a_1 a_2 \dots a_n$.
where $q_0$ is the start state and the head is on the first symbol.

Simulating transitions:

For each transition of $M$ of the form
$
\delta(q, a) \ni (p, b, D)
$
where $D$ is either $L$ or $R$, we add production rules that rewrite the configuration string accordingly.

For example, suppose $D = R$, then on a configuration substring $q a c$ (where $c$ is the symbol immediately to the right), the TM writes $b$ and moves right, entering state $p$. We can simulate this with a production
$$
q a c \to b p c.
$$
Similarly, if $D = L$, we add a rule that moves the state symbol to the left.

We also add rules that:

- Generate an initial configuration from the start symbol $S$ with the input string $w$ in it.
- Erase the tape and state information once an accepting state is reached, leaving only the original input word.

More concretely, the grammar works in stages:

1. From $S$ it generates a string that encodes "start configuration on some input word over $\Sigma$".
2. The unrestricted rules then simulate any possible sequence of nondeterministic moves of $M$, by rewriting one configuration into the next.
3. When the simulated configuration reaches an accepting state, further rules clean up the configuration so that only the input word over $\Sigma$ remains.

If $w \in L(M)$, then there exists an accepting computation of $M$ on $w$. The grammar can follow exactly that sequence of configurations via its productions, and eventually derive $w$. So $w \in L(G)$.

If $w \notin L(M)$, then there is no accepting computation of $M$ on $w$, so no sequence of configuration rewriting productions can ever reach a form that is cleaned up to just $w$. Hence $w \notin L(G)$.

Therefore every language accepted by a nondeterministic Turing machine is generated by some unrestricted grammar.

